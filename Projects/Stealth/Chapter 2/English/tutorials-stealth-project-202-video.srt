100:00:00,000 --> 00:00:01,878One of the most important parts of making200:00:01,878 --> 00:00:05,081the player move is the animator controller.300:00:05,081 --> 00:00:06,971We will start off by creating a new400:00:06,971 --> 00:00:09,632animator controller and calling it Player Animator.500:00:10,394 --> 00:00:13,373Select the Animators folder in the project panel600:00:13,373 --> 00:00:15,373and click the Create button.700:00:15,373 --> 00:00:17,676Then choose Animator Controller.800:00:17,676 --> 00:00:19,676Name it PlayerAnimator.900:00:22,400 --> 00:00:24,400This animator controller is going to be1000:00:24,400 --> 00:00:26,817relatively simple. We will start out with1100:00:26,817 --> 00:00:27,769the parameters.1200:00:28,725 --> 00:00:30,501If you do not have it open already, 1300:00:30,501 --> 00:00:32,501open up the Animator window.1400:00:32,501 --> 00:00:35,133Go to Window - Animator.1500:00:36,199 --> 00:00:39,022Create a float parameter called Speed.1600:00:39,740 --> 00:00:41,522Click the plus button to the right of1700:00:41,522 --> 00:00:43,522Parameters and choose Float.1800:00:44,574 --> 00:00:46,574Name this Speed, with a capital S.1900:00:47,820 --> 00:00:49,820Now we will need three Booleans.2000:00:50,555 --> 00:00:52,555First, one to say whether or not the player2100:00:52,555 --> 00:00:54,555is sneaking. Another to say whether2200:00:54,555 --> 00:00:57,063or not he is dead and finally2300:00:57,063 --> 00:00:59,063one for when the player is shouting.2400:00:59,881 --> 00:01:02,144We will call them Sneaking, Dead and2500:01:02,144 --> 00:01:04,144Shouting respectively.2600:01:06,371 --> 00:01:08,842Now we are ready to start making the states.2700:01:09,342 --> 00:01:12,258We will start by dragging in an idle animation.2800:01:12,258 --> 00:01:14,258This will be our default state.2900:01:14,258 --> 00:01:16,258You will find the FBX of this animation3000:01:16,258 --> 00:01:18,092in the Animations folder,3100:01:18,634 --> 00:01:20,634in the Humanoids subfolder.3200:01:21,134 --> 00:01:23,890Open up Animations in the project panel3300:01:23,890 --> 00:01:26,566and select Humanoid. You will then find3400:01:26,566 --> 00:01:28,566humanoid_idle.3500:01:28,997 --> 00:01:32,324Expand this FBX and drag and drop idle3600:01:33,059 --> 00:01:35,059in to the Animator window.3700:01:35,835 --> 00:01:37,835Because this is our default state it is3800:01:37,835 --> 00:01:40,265highlighted in orange, and we want3900:01:40,265 --> 00:01:42,265to see how this affects our character.4000:01:42,265 --> 00:01:44,265So let's dock our animator below4100:01:44,265 --> 00:01:46,265the scene view,4200:01:47,594 --> 00:01:49,594reselect our character4300:01:49,594 --> 00:01:52,312char_ethan in the hierarchy.4400:01:52,312 --> 00:01:54,312In order to make this animation applied4500:01:54,312 --> 00:01:57,081to our character we need to drop the animator4600:01:57,081 --> 00:01:59,402controller asset on to the control4700:01:59,402 --> 00:02:01,402property of the animator.4800:02:02,648 --> 00:02:04,648Select the Animators folder and drag4900:02:04,648 --> 00:02:07,246and drop the animator that we just made.5000:02:07,839 --> 00:02:09,839Now if we press play.5100:02:09,839 --> 00:02:11,839We will see that the idle clip is applied5200:02:11,839 --> 00:02:13,839to our character.5300:02:23,620 --> 00:02:26,468Press play once more and we will continue.5400:02:27,971 --> 00:02:30,506Reselect the Animator window and this time5500:02:30,506 --> 00:02:33,144we want to add some motion. To get a smooth5600:02:33,144 --> 00:02:36,301acceleration we are going to use a blend tree.5700:02:36,301 --> 00:02:38,301Create a new blend tree by right clicking5800:02:38,301 --> 00:02:40,301in empty space and choosing5900:02:40,301 --> 00:02:43,597Create State - From New Blend Tree.6000:02:45,285 --> 00:02:48,190This is a new state based on a blend tree6100:02:48,190 --> 00:02:50,190and we need to name both the state6200:02:50,190 --> 00:02:52,985and the blend tree. When we are in this view6300:02:52,985 --> 00:02:54,985we can see the state itself, 6400:02:54,985 --> 00:02:56,985and we will name it Locomotion.6500:03:01,546 --> 00:03:03,197Then double click on this state to6600:03:03,197 --> 00:03:05,197enter the blend tree.6700:03:07,092 --> 00:03:10,511Now rename the blend tree Locomotion also.6800:03:15,155 --> 00:03:17,155We will add two motion fields to this6900:03:17,155 --> 00:03:19,155blend tree by clicking the plus button7000:03:19,155 --> 00:03:21,985and selecting Add Motion Field.7100:03:27,499 --> 00:03:29,499Next we will add the two animations for 7200:03:29,499 --> 00:03:32,166the motion fields. First add Walk7300:03:32,166 --> 00:03:34,564and then Run. We will do this by clicking7400:03:34,564 --> 00:03:36,882the circle select button to the right7500:03:36,882 --> 00:03:39,372of the motion fields, and then choosing7600:03:39,372 --> 00:03:41,372the animation from the list.7700:03:41,872 --> 00:03:43,872Search for Walk7800:03:44,759 --> 00:03:46,375and select it here.7900:03:46,983 --> 00:03:48,983Then close the selection window.8000:03:49,994 --> 00:03:51,994Then click the circle select button to the8100:03:51,994 --> 00:03:53,246right of the second field8200:03:53,775 --> 00:03:55,332and search for run8300:03:56,785 --> 00:03:58,785and select it.8400:03:59,644 --> 00:04:02,312Finally we can compute the thresholds.8500:04:02,312 --> 00:04:05,428To do this uncheck Automate Thresholds8600:04:05,428 --> 00:04:08,778and select Compute Thresholds - Speed.8700:04:14,195 --> 00:04:16,195This will calculate appropriate values8800:04:16,195 --> 00:04:18,695of the speed parameter for each animation8900:04:18,695 --> 00:04:21,254based on their motion. Note the value of the9000:04:21,254 --> 00:04:22,633threshold for Run.9100:04:23,133 --> 00:04:25,133We will be using an approximation of this9200:04:25,133 --> 00:04:27,478later in our Player Movement script.9300:04:27,910 --> 00:04:30,105Next we can make the transitions too9400:04:30,105 --> 00:04:33,578and from these states. Returned to the base layer9500:04:34,796 --> 00:04:36,796and then right click the Idle state.9600:04:37,545 --> 00:04:39,545and click Make Transition.9700:04:41,288 --> 00:04:43,288This gives us a transition to drop9800:04:43,288 --> 00:04:46,035on to another state. Simply click on the9900:04:46,035 --> 00:04:48,035Locomotion state to apply it.10000:04:48,035 --> 00:04:50,435To edit the transition select it.10100:04:50,990 --> 00:04:53,699We then have properties for it in the inspector10200:04:53,699 --> 00:04:55,699and a condition for us to go from10300:04:55,699 --> 00:04:57,573Idle in to Locomotion.10400:04:58,116 --> 00:05:00,116The conditions need to be set so that speed10500:05:00,116 --> 00:05:02,681should be greater than 0.1.10600:05:03,333 --> 00:05:05,707So from the drop down select Speed,10700:05:06,870 --> 00:05:08,870leave the default of Greater10800:05:09,370 --> 00:05:11,370and say 0.1.10900:05:12,574 --> 00:05:15,109We also need Sneaking to be false11000:05:15,109 --> 00:05:16,657So click the plus button to add11100:05:16,657 --> 00:05:18,657another condition,11200:05:19,627 --> 00:05:22,701choose Sneaking and set it to false.11300:05:23,878 --> 00:05:25,878Now we need a transition to go back to11400:05:25,878 --> 00:05:27,878Idle from Locomotion.11500:05:27,878 --> 00:05:29,878So right click on Locomotion,11600:05:29,878 --> 00:05:32,724choose Make Transition and click on Idle.11700:05:34,094 --> 00:05:35,663Select the transition back11800:05:36,345 --> 00:05:38,345and the condition that we need here is11900:05:38,345 --> 00:05:43,440that speed is less than 0.1.12000:05:46,495 --> 00:05:49,400The next state is Sneak. The FBX of the animation12100:05:49,400 --> 00:05:51,400is again in the Humanoid folder12200:05:51,400 --> 00:05:53,400under Animations and is called 12300:05:53,400 --> 00:05:55,261humanoid_sneak.12400:05:55,637 --> 00:05:57,637Expand this and then drag on the 12500:05:57,637 --> 00:05:59,637animation called Sneak Forward.12600:06:01,960 --> 00:06:03,960We will arrange these a bit more tidily.12700:06:04,460 --> 00:06:06,460You can drag states around in the window12800:06:06,460 --> 00:06:08,460in order to make them neater.12900:06:09,512 --> 00:06:12,415Grab Locomotion and move it out of the way13000:06:12,915 --> 00:06:14,915and then move Sneak Forward up to the left13100:06:14,915 --> 00:06:16,915to form a triangle shape.13200:06:17,360 --> 00:06:19,360You can hold down ALT at any time13300:06:19,360 --> 00:06:21,992to drag around inside the animator window.13400:06:21,992 --> 00:06:24,495For simplicity and consistency let us also13500:06:24,495 --> 00:06:27,076rename our state to simply Sneak.13600:06:27,076 --> 00:06:29,076Make sure it is selected in the animator13700:06:29,076 --> 00:06:31,076and rename it at the top of the inspector13800:06:31,076 --> 00:06:33,076to simply Sneak.13900:06:33,576 --> 00:06:35,576Let us deal with the transitions to and14000:06:35,576 --> 00:06:37,576from Locomotion first.14100:06:38,076 --> 00:06:40,076In both cases we need to make sure that 14200:06:40,076 --> 00:06:42,076speed is greater than 0.114300:06:42,076 --> 00:06:44,076and if we are transitioning to Sneak14400:06:44,576 --> 00:06:46,576then we need the Sneaking parameter to be true.14500:06:47,076 --> 00:06:50,290If we are transitioning away we need it to be false.14600:06:51,260 --> 00:06:53,733Select the Locomotion state,14700:06:53,733 --> 00:06:56,161right click and make transition.14800:06:56,937 --> 00:06:58,937Then select Sneak.14900:06:59,782 --> 00:07:01,698Select the transition to edit it in the 15000:07:01,698 --> 00:07:04,374inspector and in the conditions table15100:07:05,454 --> 00:07:08,509make sure that Speed is greater than 0.115200:07:10,694 --> 00:07:12,876and then add a second condition,15300:07:12,876 --> 00:07:15,767which says that sneaking should be true.15400:07:16,423 --> 00:07:18,423Now we need the transition back.15500:07:18,730 --> 00:07:20,730Right click on Sneak15600:07:21,603 --> 00:07:23,603and click on Locomotion.15700:07:23,965 --> 00:07:25,965Select the transition back15800:07:25,965 --> 00:07:28,930and in the conditions ensure that Speed15900:07:28,930 --> 00:07:30,930is greater than 0.116000:07:31,844 --> 00:07:34,162as it needs to be in order to walk or run,16100:07:34,731 --> 00:07:36,358then add a second condition16200:07:36,996 --> 00:07:39,768that says that Sneaking must be false.16300:07:41,332 --> 00:07:42,900Now we need the transitions16400:07:42,900 --> 00:07:46,278to and from Idle. To go to Idle from Sneak16500:07:46,278 --> 00:07:49,418we simply need Speed to be less than 0.1.16600:07:49,418 --> 00:07:52,621However to go from Idle in to Sneak16700:07:52,621 --> 00:07:55,046we need that Speed is greater than 0.116800:07:55,046 --> 00:07:57,046and that sneaking is true. Right click on16900:07:57,046 --> 00:07:59,811Sneak and choose Make Transition17000:08:00,476 --> 00:08:02,003then click on Idle.17100:08:02,949 --> 00:08:05,255Select the transition and set the condition17200:08:05,255 --> 00:08:08,147for Speed to be less than 0.1.17300:08:10,567 --> 00:08:14,100Now right click on Idle and choose Make Transition.17400:08:15,525 --> 00:08:17,138Then select Sneak.17500:08:17,638 --> 00:08:19,638Select the transition and under the17600:08:19,638 --> 00:08:22,929conditions ensure that Speed17700:08:23,553 --> 00:08:26,359is greater than 0.117800:08:28,171 --> 00:08:30,171and then add a second condition that says17900:08:30,171 --> 00:08:32,433that Sneaking must be true.18000:08:32,433 --> 00:08:34,002The final state that we are going to make18100:08:34,002 --> 00:08:36,002on this layer is Dying.18200:08:36,002 --> 00:08:38,002We do so, as before, by dragging18300:08:38,002 --> 00:08:40,957the animation in to the animator window.18400:08:40,957 --> 00:08:43,431The FBX is in the same folder as before18500:08:43,431 --> 00:08:45,997and is called humanoid_dying.18600:08:46,497 --> 00:08:50,039Expand this FBX to reveal the Dying animation.18700:08:50,039 --> 00:08:52,039We need this state to be near the 18800:08:52,039 --> 00:08:54,039Any State as we are going to transition18900:08:54,039 --> 00:08:57,021from this. Rearrange your states so that19000:08:57,021 --> 00:08:59,021Any State is over to the left of our19100:08:59,021 --> 00:09:01,999existing states. Then drag and drop the dying19200:09:01,999 --> 00:09:04,416animation in to the animator window.19300:09:05,369 --> 00:09:07,369The Any State is there to allow us to 19400:09:07,369 --> 00:09:09,369transition in to another state without19500:09:09,369 --> 00:09:11,770being in any particular state to begin with.19600:09:12,532 --> 00:09:15,151So, in order to die we could be in any19700:09:15,151 --> 00:09:17,151of the existing states, rather than make19800:09:17,151 --> 00:09:19,151transitions from all of them we can use19900:09:19,151 --> 00:09:21,151Any State to jump out of our other states20000:09:21,151 --> 00:09:23,151in to another state.20100:09:23,651 --> 00:09:26,351So we can right click on Any State20200:09:26,351 --> 00:09:27,950to choose Make Transition20300:09:28,520 --> 00:09:31,396and select Dying. Select the transition20400:09:31,896 --> 00:09:35,667and in the condition we need Dead to be true.20500:09:36,871 --> 00:09:38,871And there he is.20600:09:44,675 --> 00:09:46,675Next we are going to have an additional layer20700:09:46,675 --> 00:09:48,675of animation so that the player can have a20800:09:48,675 --> 00:09:51,065shouting animation whilst in any of the20900:09:51,065 --> 00:09:53,065states in our base layer.21000:09:53,065 --> 00:09:55,065Before we can do that though we need to make21100:09:55,065 --> 00:09:57,823an avatar mask so that only the parts of21200:09:57,823 --> 00:09:59,823the player that need to move do so21300:09:59,823 --> 00:10:01,228when shouting.21400:10:02,323 --> 00:10:04,323You will find the Shouting animation in the21500:10:04,323 --> 00:10:07,690same folder, it is called humanoid_shout.21600:10:08,922 --> 00:10:10,922Beneath this you should see the Shout21700:10:10,922 --> 00:10:13,909animation itself. Select the FBX21800:10:13,909 --> 00:10:16,383and you will see that when playing it back21900:10:16,823 --> 00:10:19,129the character raises his arm to his mouth22000:10:19,129 --> 00:10:21,129to shout. However we do not want22100:10:21,129 --> 00:10:23,129the rest of the motion from this to be22200:10:23,129 --> 00:10:25,129affecting our character, so we will22300:10:25,129 --> 00:10:27,129create the avatar mask.22400:10:28,209 --> 00:10:30,209We will save this in to the Animator folder22500:10:30,209 --> 00:10:32,747as it is used directly with our animator.22600:10:33,247 --> 00:10:35,477Select the animators folder and 22700:10:35,477 --> 00:10:38,093create and avatar mask.22800:10:39,049 --> 00:10:41,576We will call this PlayerShoutingMask.22900:10:42,504 --> 00:10:44,671With this asset selected we can edit23000:10:44,671 --> 00:10:47,611it in the inspector. We only need to use the23100:10:47,611 --> 00:10:50,369body mask, so expand this area now.23200:10:50,369 --> 00:10:52,369Now deselect everything other than the23300:10:52,369 --> 00:10:54,369left arm, hand and head.23400:10:56,002 --> 00:10:58,002Now we can make our additional layer of23500:10:58,002 --> 00:11:01,079animation. Everything we have made so far has23600:11:01,079 --> 00:11:03,079been on the base layer. We can add23700:11:03,079 --> 00:11:05,079an additional layer of animation by clicking23800:11:05,079 --> 00:11:07,616on the plus icon to the right of Layers23900:11:07,616 --> 00:11:10,165in the top left of the Animator window.24000:11:11,262 --> 00:11:13,262We will name this new layer Shouting.24100:11:14,107 --> 00:11:16,107Next click the circle select button24200:11:16,107 --> 00:11:19,479next to Mask and choose a mask to apply.24300:11:20,262 --> 00:11:23,300Choose PlayerShoutingMask here.24400:11:25,223 --> 00:11:27,223By adding this second layer of animation24500:11:27,223 --> 00:11:29,223and masking it we will be able to24600:11:29,223 --> 00:11:31,888call it via script during any other state 24700:11:31,888 --> 00:11:33,888of animation. Now we are going to add some24800:11:33,888 --> 00:11:36,400states to this layer. The first think we24900:11:36,400 --> 00:11:38,400want to have is an empty state.25000:11:38,400 --> 00:11:40,874Do this by right clicking and choosing25100:11:40,874 --> 00:11:42,874Create State - Empty.25200:11:44,175 --> 00:11:46,175We need this empty state so that when25300:11:46,175 --> 00:11:48,175this layer is not in the Shout state25400:11:48,175 --> 00:11:50,749then nothing is being played back by this layer25500:11:50,749 --> 00:11:52,749and therefore nothing is overriding25600:11:52,749 --> 00:11:54,749the animation on the base layer.25700:11:55,249 --> 00:11:58,021Now we will drag in the Shout animation.25800:11:59,170 --> 00:12:02,064Reselect the Humanoid folder under Animations25900:12:02,575 --> 00:12:05,482and expand Shout. Drag and drop it in to26000:12:05,482 --> 00:12:07,011the animator window.26100:12:07,830 --> 00:12:09,830Finally we need some transitions to and26200:12:09,830 --> 00:12:12,258from these states. The condition for26300:12:12,258 --> 00:12:14,258transitioning in to the Shout state26400:12:14,258 --> 00:12:16,258is that the Shouting Boolean is true.26500:12:16,758 --> 00:12:18,758So right click on the empty new state26600:12:18,758 --> 00:12:20,758and click Make Transition.26700:12:21,548 --> 00:12:23,089Then click on Shout.26800:12:23,558 --> 00:12:25,841Select the transition itself26900:12:25,841 --> 00:12:29,176and under Conditions choose Shouting.27000:12:29,980 --> 00:12:31,980By default it should be set to true.27100:12:33,765 --> 00:12:35,765Then right click on Shout, choose27200:12:35,765 --> 00:12:39,694Make Transition and select the orange empty state.27300:12:40,360 --> 00:12:42,360Select the transition back and you should27400:12:42,360 --> 00:12:43,957see that it is set by default to27500:12:43,957 --> 00:12:47,026Exit Time, which is the default that we need.27600:12:47,026 --> 00:12:48,261This means that when the animation is 27700:12:48,261 --> 00:12:50,261finished playing it will simply transition27800:12:50,261 --> 00:12:51,984back in to the empty state.27900:12:51,984 --> 00:12:53,766That concludes our work on the players28000:12:53,766 --> 00:12:55,766animator controller.28100:12:56,266 --> 00:13:00,325Save your scene and save your project now.