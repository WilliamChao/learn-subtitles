100:00:00,000 --> 00:00:01,970Something we want our game to have is 200:00:01,970 --> 00:00:03,970smooth transitions between scenes. 300:00:04,470 --> 00:00:06,470Since we are only going to have one scene400:00:06,470 --> 00:00:08,470it will simply fade in from back500:00:08,470 --> 00:00:10,994when the scene starts and fade out to black600:00:10,994 --> 00:00:12,994when the scene ends, and then load700:00:12,994 --> 00:00:15,761the scene again. To achieve this effect800:00:15,761 --> 00:00:17,761we're going to have a GUI texture stretched900:00:17,761 --> 00:00:20,108over the scene that we will change from black1000:00:20,108 --> 00:00:23,189to transparent and back when we need it.1100:00:23,689 --> 00:00:25,910To start off we'll make a GUI texture.1200:00:25,910 --> 00:00:27,910Click the Create button on the hierarchy1300:00:27,910 --> 00:00:29,688and choose GUI Texture.1400:00:29,688 --> 00:00:32,050We'll rename it screenFader,1500:00:32,975 --> 00:00:35,603and then tag as Fader.1600:00:37,402 --> 00:00:39,766The GUI texture's position is in screen1700:00:39,766 --> 00:00:41,766space, this means that the default1800:00:41,766 --> 00:00:45,003(0.5, 0.5) in the transforms position1900:00:45,003 --> 00:00:46,583is centred on the screen.2000:00:46,583 --> 00:00:49,041We're going to set the position to (0, 0)2100:00:49,041 --> 00:00:52,146so that it begins in the bottom left of the screen.2200:00:54,234 --> 00:00:56,234We have a black texture already prepared2300:00:56,234 --> 00:00:58,775in the Textures folder. Open the Textures folder2400:00:58,775 --> 00:01:01,246and locate swatch_black_diff.2500:01:01,246 --> 00:01:04,243Drag and drop this on as the texture to use.2600:01:05,737 --> 00:01:07,430So that we have a clear game screen2700:01:07,430 --> 00:01:09,720to work with we'll set all of the pixel2800:01:09,720 --> 00:01:11,499inset values to 0.2900:01:11,999 --> 00:01:13,999Now we need a script to handle the fading.3000:01:13,999 --> 00:01:16,592We'll call it SceneFadeInOut.3100:01:17,092 --> 00:01:19,092Select the Scripts folder in the project panel3200:01:19,092 --> 00:01:21,413and go to Create C# Script.3300:01:21,413 --> 00:01:25,858Name this SceneFadeInOut.3400:01:26,910 --> 00:01:28,551Select the scene fader3500:01:29,134 --> 00:01:31,134and drop it on to the inspector.3600:01:31,800 --> 00:01:33,465Bare in mind this is just another way3700:01:33,465 --> 00:01:35,009of creating and attaching a script3800:01:35,009 --> 00:01:37,590to a game object. Similarly, we could have3900:01:37,590 --> 00:01:40,530hit Add Component and created a new script there.4000:01:41,030 --> 00:01:43,030Doing it this way allows us to specify4100:01:43,030 --> 00:01:44,947a folder in which to keep the script4200:01:44,947 --> 00:01:47,098as we create it. Double click the icon4300:01:47,098 --> 00:01:48,917of the script to open it for editing.4400:01:49,308 --> 00:01:52,025As usual, remove the contents of the script4500:01:52,025 --> 00:01:54,025to prepare it for writing.4600:01:54,787 --> 00:01:56,356We'll start out with the class variables4700:01:56,356 --> 00:01:59,146that we need. In this class we'll only need4800:01:59,146 --> 00:02:02,118one public variable and one private variable.4900:02:02,491 --> 00:02:04,296The public variable should be a float5000:02:04,296 --> 00:02:06,296we'll call fadeSpeed.5100:02:06,796 --> 00:02:08,516We'll use it to adjust how quickly the5200:02:08,516 --> 00:02:10,145screen fades in and out.5300:02:10,645 --> 00:02:13,415We'll give this a default value of 1.55400:02:13,415 --> 00:02:14,897but we can change this later in the5500:02:14,897 --> 00:02:16,618inspector if we wish.5600:02:17,549 --> 00:02:19,549In this script we're going to have functions5700:02:19,549 --> 00:02:21,549for the start and end of the scene.5800:02:21,549 --> 00:02:23,549Since when the scene ends will be decided5900:02:23,549 --> 00:02:25,549by other scripts we don't need to tell6000:02:25,549 --> 00:02:28,258this class when that is. However we will need6100:02:28,258 --> 00:02:30,670a variable to say when the scene is starting6200:02:30,670 --> 00:02:32,491and should still be fading in.6300:02:32,491 --> 00:02:34,491A Boolean will do this job nicely.6400:02:34,491 --> 00:02:36,491By default the scene is starting6500:02:36,491 --> 00:02:38,491so we'll set the default to be true.6600:02:39,709 --> 00:02:41,390Next we're going to do some setup6700:02:41,390 --> 00:02:44,200in the Awake function. Add the Awake function now.6800:02:45,045 --> 00:02:47,445Remember we set the pixel inset to 06900:02:47,445 --> 00:02:50,131in the inspector, but by the start of the scene7000:02:50,131 --> 00:02:52,354we need the texture to be covering the screen.7100:02:52,354 --> 00:02:54,354We do this by setting the pixel inset values7200:02:54,354 --> 00:02:56,771to a new rect that we define.7300:02:57,255 --> 00:02:59,689A rect simply represents a rectangle.7400:02:59,689 --> 00:03:02,896It has four parameters, in our situation7500:03:02,896 --> 00:03:04,896they'll represent the X coordinate of the7600:03:04,896 --> 00:03:06,896bottom left corner, the Y coordinate 7700:03:06,896 --> 00:03:09,734of the bottom left corner and the width7800:03:09,734 --> 00:03:11,734and the height. These are done in pixels7900:03:11,734 --> 00:03:13,470relative to screen space.8000:03:13,970 --> 00:03:15,970Our GUI position is already in the8100:03:15,970 --> 00:03:18,319bottom left corner of the screen so the first8200:03:18,319 --> 00:03:20,319two parameters can be 0.8300:03:20,819 --> 00:03:22,458The width that we want for the texture is8400:03:22,458 --> 00:03:25,543the width of the screen. Similarly the height8500:03:25,543 --> 00:03:27,138is the height of the screen.8600:03:27,138 --> 00:03:29,660Unity has a Screen class, which stores this8700:03:29,660 --> 00:03:31,243information and we'll be using8800:03:31,243 --> 00:03:32,661the values from that.8900:03:33,520 --> 00:03:35,520Next we will add an update function.9000:03:35,520 --> 00:03:37,203We won't be using it just yet, but we9100:03:37,203 --> 00:03:38,830will come back to it in a moment.9200:03:40,476 --> 00:03:42,476We're going to use Lerp a couple of times9300:03:42,476 --> 00:03:45,002in this script. As such, we're going to make9400:03:45,002 --> 00:03:46,891a couple of shortcut functions.9500:03:46,891 --> 00:03:48,516They will make it easier to see what is9600:03:48,516 --> 00:03:50,167happening in the script without having to9700:03:50,167 --> 00:03:52,761look to see what the lerp function is doing.9800:03:52,761 --> 00:03:55,258The first one will be FadeToClear.9900:03:56,697 --> 00:03:58,697The colour that we will be lerping is10000:03:58,697 --> 00:04:01,689the GUI texture's colour and we'll be lerping10100:04:01,689 --> 00:04:03,689it between itself and clear, using the 10200:04:03,689 --> 00:04:06,413alpha property. We will use the fadeSpeed10300:04:06,413 --> 00:04:08,413to control the time parameter.10400:04:11,675 --> 00:04:13,467Now we can create a similar function10500:04:13,467 --> 00:04:15,258for fading to black. 10600:04:15,258 --> 00:04:17,258Copy the FadeToClear function10700:04:17,258 --> 00:04:19,258but change the name to FadeToBlack10800:04:19,258 --> 00:04:21,900and the target colour to Colour.black.10900:04:23,394 --> 00:04:25,394Next we're going to need a function that will11000:04:25,394 --> 00:04:27,394be called to control the fading at the11100:04:27,394 --> 00:04:29,142start of the scene.11200:04:29,142 --> 00:04:31,142It will need to be called in Update11300:04:31,142 --> 00:04:33,142so that the colour of the GUI texture11400:04:33,142 --> 00:04:34,822can change smoothly.11500:04:35,863 --> 00:04:37,501The first thing we need to do when the11600:04:37,501 --> 00:04:40,018scene is starting is to fade to clear.11700:04:40,018 --> 00:04:42,852So let's put a call to our shortcut function here.11800:04:43,573 --> 00:04:45,752Now an important thing to remember about lerp11900:04:45,752 --> 00:04:47,752is that you are changing by a percentage12000:04:47,752 --> 00:04:49,752of the difference between two values.12100:04:49,752 --> 00:04:51,752This means that it will take quite a long12200:04:51,752 --> 00:04:54,287time to actually reach the target colour.12300:04:54,287 --> 00:04:56,287As such, instead of making any changes12400:04:56,287 --> 00:04:57,498that we need to make when the12500:04:57,498 --> 00:04:59,498colour reaches clear, we're going to12600:04:59,498 --> 00:05:01,665make them when it's very close to clear.12700:05:01,665 --> 00:05:03,665In a similar way to our change margin12800:05:03,665 --> 00:05:06,448for fading between the main light and alarm light.12900:05:06,448 --> 00:05:08,448The colour is very close to clear when it's13000:05:08,448 --> 00:05:11,134alpha is low. So we will check for that.13100:05:13,388 --> 00:05:15,014At this point we want to set the colour13200:05:15,014 --> 00:05:17,014to be clear so that when we next use13300:05:17,014 --> 00:05:19,442the GUI texture we get a smooth transition13400:05:19,442 --> 00:05:20,691back to black.13500:05:21,909 --> 00:05:23,909Despite the texture being absolutely13600:05:23,909 --> 00:05:26,054transparent Unity will need to check it's13700:05:26,054 --> 00:05:28,054alpha each frame to determine how13800:05:28,054 --> 00:05:30,054things behind it are rendered.13900:05:30,054 --> 00:05:32,054This will slow down the game slightly.14000:05:32,054 --> 00:05:34,054We're going to prevent this by disabling14100:05:34,054 --> 00:05:36,054the GUI texture component and therefore14200:05:36,054 --> 00:05:37,692stopping it from rendering.14300:05:38,678 --> 00:05:40,678Lastly, at this point the scene is no14400:05:40,678 --> 00:05:42,998longer starting, so we can set our14500:05:42,998 --> 00:05:45,122scene starting variable to false.14600:05:45,843 --> 00:05:47,452The last function we need to make for14700:05:47,452 --> 00:05:50,246this script is the end scene function.14800:05:50,246 --> 00:05:52,246It's important to note that this won't be14900:05:52,246 --> 00:05:54,246called from this script, so we need to make15000:05:54,246 --> 00:05:55,854the function public.15100:05:57,547 --> 00:05:59,547Firstly we want to make sure that the GUI15200:05:59,547 --> 00:06:01,785texture component is enabled.15300:06:04,008 --> 00:06:05,494And since the scene is ending,15400:06:05,494 --> 00:06:07,149we want to fade to black.15500:06:08,436 --> 00:06:10,037In the same way that we check to see if15600:06:10,037 --> 00:06:12,037screen was clear by checking whether the15700:06:12,037 --> 00:06:14,704alpha of the texture was low, we want to15800:06:14,704 --> 00:06:16,320check if the screen is black by seeing15900:06:16,320 --> 00:06:18,320if the alpha of the texture is high.16000:06:21,638 --> 00:06:23,638When the screen has faded to black we want16100:06:23,638 --> 00:06:25,207to reload the level.16200:06:26,911 --> 00:06:30,055We do this with the Application.LoadLevel function.16300:06:30,055 --> 00:06:31,794Before we can fill in the level that we16400:06:31,794 --> 00:06:33,794want to load we need to add our scene16500:06:33,794 --> 00:06:35,336to the build settings.16600:06:35,836 --> 00:06:37,836We can access them from the file menu16700:06:37,836 --> 00:06:40,487of the editor. So return to the editor16800:06:40,487 --> 00:06:42,460briefly to look at this. Go to 16900:06:42,460 --> 00:06:44,279File - Build Settings.17000:06:44,279 --> 00:06:45,948Now we will add the scene we are building17100:06:45,948 --> 00:06:47,948by clicking the Add Current button.17200:06:48,448 --> 00:06:50,448Notice that the scene is added to the list17300:06:50,448 --> 00:06:52,641and has an index number to the right of it.17400:06:53,169 --> 00:06:54,961If you have not added any other scenes to17500:06:54,961 --> 00:06:57,404the list the index should be 117600:06:57,973 --> 00:06:59,764because the existing finished version of17700:06:59,764 --> 00:07:01,764the scene will already be there and17800:07:01,764 --> 00:07:03,764has an index of 0.17900:07:03,764 --> 00:07:05,764We can now return to our script and put18000:07:05,764 --> 00:07:07,917in the correct scene index.18100:07:07,917 --> 00:07:10,552So close the build settings and return to18200:07:10,552 --> 00:07:13,236editing the script. Place a value of 118300:07:13,236 --> 00:07:15,556within the parenthesis of LoadLevel.18400:07:16,595 --> 00:07:18,595Now that we have our functions we can return18500:07:18,595 --> 00:07:20,595to the Update function and fill in18600:07:20,595 --> 00:07:21,997what we need there.18700:07:22,570 --> 00:07:24,570We need to put a call to our start scene18800:07:24,570 --> 00:07:26,998function, but only on the condition18900:07:26,998 --> 00:07:28,998that the scene is starting.19000:07:30,341 --> 00:07:31,884Now our script is complete19100:07:32,522 --> 00:07:35,607so save it and return to the editor.19200:07:35,607 --> 00:07:37,607Now I can drag our screen fader object19300:07:37,607 --> 00:07:40,399in to the Prefabs folder to save it there.19400:07:40,399 --> 00:07:42,343We've now completed our screen fader.19500:07:42,747 --> 00:07:44,484Remember to save your scene,19600:07:45,233 --> 00:07:46,830save the project19700:07:47,565 --> 00:07:49,565and in the next assignment we'll look at19800:07:49,565 --> 00:07:51,041creating the game controller.